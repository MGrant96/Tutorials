"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.FileUtil = void 0;
var fs_1 = __importDefault(require("fs"));
var path_1 = __importDefault(require("path"));
var rimraf = require('rimraf');
var FileUtil = /** @class */ (function () {
    function FileUtil() {
    }
    FileUtil.cleanupFolderByDate = function (folder_path, hours, cb) {
        if (cb === void 0) { cb = null; }
        if (!folder_path)
            return;
        fs_1.default.readdir(folder_path, function (err, files) {
            var len = files.length;
            var _loop_1 = function (i) {
                fs_1.default.stat(path_1.default.join(folder_path, files[i]), function (err, stat) {
                    if (err) {
                        if (cb)
                            cb(err);
                        console.error("Failed to get stats", err);
                    }
                    else {
                        var now = new Date().getTime();
                        var endTime = new Date(stat.ctime).getTime() + 3600000 * hours;
                        if (now > endTime) {
                            rimraf(path_1.default.join(folder_path, files[i]), function (err) {
                                if (err) {
                                    if (cb)
                                        cb(err);
                                    console.error("Failed to delete file", err);
                                }
                                else {
                                    if (cb)
                                        cb(null);
                                }
                            });
                        }
                    }
                });
            };
            for (var i = 0; i < len; ++i) {
                _loop_1(i);
            }
        });
    };
    return FileUtil;
}());
exports.FileUtil = FileUtil;
//# sourceMappingURL=file.util.js.map